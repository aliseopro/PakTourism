function checkForSearchFlight(){var e,t,a;""==$("#fromAirport").val()||""==$("#toAirport").val()?alert(FmtMessage.getMessage("js.flight.search.empty.city.warning")):$("#fromAirportCity").val()&&$("#fromAirportCity").val()==$("#toAirportCity").val()?alert(FmtMessage.getMessage("js.flight.search.warning")):(a=$("#paxADT").val(),t=$("#paxCHD").val(),e=$("#paxINF").val(),(t=(a=parseInt(a))+parseInt(t)+parseInt(e))<1?alert(FmtMessage.getMessage("js.search.warning.1pax")):a<1?alert(FmtMessage.getMessage("js.search.warning.1adult")):a<e?alert(FmtMessage.getMessage("js.search.warning.infant.adult")):9<t?alert(sprintf(FmtMessage.getMessage("js.search.warning.paxcount"),9)):$("#searchForm").valid()&&($("#loading").modal("show"),a=URL_MAPPING.resolveUrl("/searchFlights"),document.searchForm.action=a,document.searchForm.submit()))}var Transfer={transferNumAdult:null,transferNumChild:null,transferNumInfant:null,resultTable:$("#transferResultTable div.result-row")},transferSearch={searchAutoCompleteIdFrom:null,searchAutoCompleteIdTo:null,searchUrlFrom:null,searchUrlTo:null,fromDate:null,toDate:null},autoCompleteResult="",totalAdult=0,totalChild=0,totalRoomCount=0,hotelSearch={searchAutoCompleteId:null,searchUrl:null,fromDate:null,toDate:null};function parseCookieSearchValues(){var e;$.cookie("transferSearchValues")&&(e=JSON.parse($.cookie("transferSearchValues")),$("#fromLocationId").val(e.searchAutoCompleteIdFrom),$("#fromLocation").val(e.searchUrlFrom),$("#toLocationId").val(e.searchAutoCompleteIdTo),$("#toLocation").val(e.searchUrlTo),null!=e.fromDate&&$('input[name="transferDate"]').val(e.fromDate),null!=e.toDate&&($('input[name="returnDate"]').val(e.toDate),$("#clearReturn").show()))}function getHotelItemLabels(e){return $.map(e,function(e){return"HOTEL"==e.category&&(e.value=e.name),e})}function bindDatePicker(){0!=$("#dates").length&&($("#dates").daterangepicker({minDate:moment(),minYear:2022,maxYear:parseInt(moment().format("YYYY"),10),locale:{format:"DD MMM, YYYY"},startDate:0<$('input[name="checkInDate"]').val().length?moment($('input[name="checkInDate"]').val(),"DD.MM.YYYY"):moment(),endDate:0<$('input[name="checkOutDate"]').val().length?moment($('input[name="checkOutDate"]').val(),"DD.MM.YYYY"):moment()}),$("#dates").on("apply.daterangepicker",function(e,t){$('input[name="checkInDate"]').val(t.startDate.format("DD.MM.YYYY")),$('input[name="checkOutDate"]').val(t.endDate.format("DD.MM.YYYY")),$("#nightsLabel").html(t.endDate.diff(t.startDate,"days")+" NIGHT")}))}function bindRoomSelector(e){null==e&&(e=document),$(".roomSelect",e).on("change",function(e){for(var t=$(this).val(),a=1;a<5;a++)a<=t?$(".room"+a).addClass("d-flex").show():$(".room"+a).hide().removeClass("d-flex");setTotalGuest($(this).closest("form"))}).change(),$(".childCount",e).on("change",function(e){var t=parseInt(this.value),a=this.name.split("_")[1];$("[name="+this.name+"]").val(t);for(var o=1;o<4;o++)o<=t?$(".childAge"+a+o).show():$(".childAge"+a+o).hide();setTotalGuest($(this).closest("form"))}).change(),$(".adultCount",e).on("change",function(e){$("[name="+this.name+"]").val(parseInt(this.value)),setTotalGuest($(this).closest("form"))}).change(),$(".childAge",e).on("change",function(e){$("[name="+this.name+"]").val(parseInt(this.value))}).change()}function setTotalGuest(e){for(var t=parseInt(e.find("#glRoomCount").val()),a=0,o=0,r=1;r<=t;r++)a+=parseInt(e.find("[name=adultCount_"+r+"]").val()),o+=parseInt(e.find("[name=childCount_"+r+"]").val());var n=a+o;$(".labelGuest").html(n)}function parseHotelCookieSearchValues(){var e,t,a,o,r,n;$('input[type=hidden][name="overrideSearchForm"]')&&$('input[type=hidden][name="overrideSearchForm"]').val()&&putHotelCookieSearchValues(),$.cookie("hotelSearchValues")&&(e=moment(),t=JSON.parse($.cookie("hotelSearchValues")),$(".hotelAutoComplete").data("autoCompleteResult",t.searchAutoCompleteId),$('[name="urlHotelName"]').length||$("<input>").attr({type:"hidden",id:"urlHotelName",name:"urlHotelName"}).appendTo(this.form),$('[name="urlHotelName"]').val(t.searchUrl),$('[name="hotelName"]').val(t.searchUrl),$('[name="id"]').val(t.searchAutoCompleteId),(o=a=null)!=t.fromDate&&(a=moment(t.fromDate,"DD.MM.YYYY"),n=t.fromDate,r=a.format("DD MMM, YYYY"),e.isAfter(a)&&(n=(a=moment().add(1,"d")).format("DD.MM.YYYY"),r=a.format("DD MMM, YYYY")),$("#dates").data("daterangepicker").setStartDate(r),$('input[name="checkInDate"]').val(n)),null!=t.toDate&&(o=moment(t.toDate,"DD.MM.YYYY"),r=t.toDate,n=o.format("DD MMM, YYYY"),e.isAfter(o)&&(r=(o=moment().add(7,"d")).format("DD.MM.YYYY"),n=o.format("DD MMM, YYYY")),$("#dates").data("daterangepicker").setEndDate(n),$('input[name="checkOutDate"]').val(r)),null!=a&&null!=o&&$("#nightsLabel").html(o.diff(a,"days")+" NIGHT"))}function putHotelCookieSearchValues(){var e=new Date;e.setTime(e.getTime()+864e5),hotelSearch.searchAutoCompleteId=$('[name="id"]').val(),hotelSearch.fromDate=$('[name="checkInDate"]').val(),hotelSearch.toDate=$('[name="checkOutDate"]').val(),hotelSearch.searchUrl=$('[name="urlHotelName"]').val(),$.cookie("hotelSearchValues",JSON.stringify(hotelSearch),{expires:e,path:"/"})}function checkForSearchHotel(e,t){var a=e.checkValidity(),o=$('[name="id"]',e).val(),r=$('[name="hotelName"]').val();o||$('[name="urlHotelName"]').val(r),a?(o=$("[name=checkInDate]",e).val(),r=$("[name=checkOutDate]",e).val(),o=moment(o,"DD.MM.YYYY"),30<(r=moment(r,"DD.MM.YYYY")).diff(o,"days")?(t.preventDefault(),t.stopPropagation(),$("#hotelNotFound").modal("show")):(e.classList.add("was-validated"),$("#hotelLoading").modal("show"),putHotelCookieSearchValues())):(t.preventDefault(),t.stopPropagation())}$.extend($.ui.menu.prototype.options,{items:"> :not(.ui-autocomplete-category)"}),$(document).ready(function(){$("#loading").modal({show:!1}),$("#departureDate").daterangepicker({singleDatePicker:!0,minDate:moment(),minYear:2022,maxYear:parseInt(moment().format("YYYY"),10),autoApply:!0,locale:{format:"DD.MM.YYYY"}}),$("#departureDate").on("apply.daterangepicker",function(e,t){$("label.showDepDate.day-name").html(t.startDate.format("dddd")),$("div.showDepDate.day-no").html(t.startDate.format("DD")),$("div.showDepDate.month-name").html(t.startDate.format("MMM")),$('input[name="departureDate"]').val(t.startDate.format("DD.MM.YYYY")),$("img.showDepImg").hide(),$(".showDepDate").show()}),$("#returnDate").daterangepicker({singleDatePicker:!0,autoUpdateInput:!1,minDate:moment(),minYear:2022,maxYear:parseInt(moment().format("YYYY"),10),autoApply:!0,locale:{format:"DD.MM.YYYY"}}),$("#returnDate").on("apply.daterangepicker",function(e,t){$("label.showRetDate.day-name").html(t.startDate.format("dddd")),$("div.showRetDate.day-no").html(t.startDate.format("DD")),$("div.showRetDate.month-name").html(t.startDate.format("MMM")),$('input[name="returnDate"]').val(t.startDate.format("DD.MM.YYYY")),$("img.showRetImg").hide(),$(".showRetDate").show()}),$('[name="flightRadio"]').on("change",function(){1==$(this).val()?($("#returnDate").prop("disabled",!0),$("img.showRetImg").show(),$(".showRetDate").hide()):($("#returnDate").prop("disabled",!1),$("img.showRetImg").hide(),$(".showRetDate").show())}),$("#applyClassAndPax").on("click",function(){var e=$("#paxADT").val(),t=$("#paxCHD").val(),a=$("#paxINF").val(),e=parseInt(e)+parseInt(t)+parseInt(a),t=($("#divPax").html(e),$("#selectClass option:selected").data("short"));$("#divClass").html(t)}),$.ui.autocomplete.prototype._renderItem=function(e,t){if(2!=t.atype)return ultext="<a class='' >"+t.value+"</a>",$("<li></li>").data("ui-autocomplete-item",t).append(ultext).appendTo(e);ultext="<a class='atype"+t.atype+"' >"+t.value+"</a>",$("<li></li>").data("ui-autocomplete-item",t).append(ultext).appendTo(e);for(var a=0;a<t.airports.length;a++){var o=t.airports[a];ultext="<a class='atype1'>"+o.Name+" "+o.Code+"</a></li>",$("<li></li>").data("ui-autocomplete-item",o).append(ultext).appendTo(e)}return $("<li></li>")},$(".airportAutoComplete").autocomplete({source:function(e,t){$.ajax({url:"/airports",dataType:"json",data:{output:"json",results:100,query:e.term},success:function(e){t($.map(e.ResultSet.Result.slice(0,10),function(e){return{value:e.CityName+", "+e.Name+" ("+e.Code+"), "+e.CountryCode,id:e.id,atype:e.type,name:e.Name,code:e.Code,cityName:e.CityName,countryName:e.CountryName,countryCode:e.CountryCode,airports:e.airports,city:e.CityCode}}))}})},select:function(e,t){document.activeElement.blur(),$('[name="'+$(this).attr("name")+'Id"]',this.form).val(t.item.id),t.item.city?$('[name="'+$(this).attr("name")+'City"]',this.form).val(t.item.city):t.item.CityCode&&$('[name="'+$(this).attr("name")+'City"]',this.form).val(t.item.CityCode),$(this).data("autoCompleteId",t.item.id);var a=Object.assign({},t.item);return delete a.airports,$.cookie($(this).attr("name"),JSON.stringify(a),{expires:365,path:"/"}),"searchForm"==$(this.form).attr("name")?t.item.cityName?($("#"+$(this).attr("name")+"Div").html(t.item.name+" ("+t.item.code+")"),$("#"+$(this).attr("name")).val(t.item.cityName)):($("#"+$(this).attr("name")+"Div").html(t.item.Name+" ("+t.item.Code+")"),$("#"+$(this).attr("name")).val(t.item.CityName)):t.item.cityName?($("#"+$(this).attr("name")+"Div").html(t.item.name+" ("+t.item.code+")"),$("#"+$(this).attr("name")).val(t.item.cityName),$("#"+$(this).attr("name")+"Sum").val(t.item.cityName+", "+t.item.name)):($("#"+$(this).attr("name")+"Div").html(t.item.Name+" ("+t.item.Code+")"),$("#"+$(this).attr("name")).val(t.item.CityName),$("#"+$(this).attr("name")+"Sum").val(t.item.CityName+", "+t.item.Name)),!1},open:function(e,t){$(".ui-autocomplete").off("menufocus hover mouseover mouseenter")},minLength:3}).change(function(e){var t=$('[name="'+$(this).attr("name")+'Id"]',this.form).val(),a=$('[name="'+$(this).attr("name")+'City"]',this.form).val(),t={value:this.value,id:t,city:a};$.cookie($(this).attr("name"),JSON.stringify(t),{expires:365,path:"/"})}),$(".airportAutoComplete").click(function(){$(this).select()}),$(".setSelection").click(function(){$(this).focus(),$(this).get(0).setSelectionRange(0,$(this).val().length)}),$("#fromAirport").val()||(e=$.cookie("fromAirport",{path:"/"}))&&("airports"in(a=JSON.parse(e))&&(delete a.airports,t=Object.assign({},a),$.cookie("fromAirport",JSON.stringify(t),{expires:365,path:"/"})),a.cityName?($("#fromAirport").val(a.cityName),$("#fromAirportDiv").html(a.name+" ("+a.city+")")):a.CityName&&($("#fromAirport").val(a.CityName),$("#fromAirportDiv").html(a.Name+" ("+a.Code+")")),$('[name="fromAirportId"]').val(a.id),a.city?$('[name="fromAirportCity"]').val(a.city):a.CityCode&&$('[name="fromAirportCity"]').val(a.CityCode)),$("#toAirport").val()||(e=$.cookie("toAirport",{path:"/"}))&&("airports"in(a=JSON.parse(e))&&(delete a.airports,t=Object.assign({},a),$.cookie("toAirport",JSON.stringify(t),{expires:365,path:"/"})),a.cityName?($("#toAirport").val(a.cityName),$("#toAirportDiv").html(a.name+" ("+a.city+")")):a.CityName&&($("#toAirport").val(a.CityName),$("#toAirportDiv").html(a.Name+" ("+a.Code+")")),$('[name="toAirportId"]').val(a.id),a.city?$('[name="toAirportCity"]').val(a.city):a.CityCode&&$('[name="toAirportCity"]').val(a.CityCode)),$("#transferDate").daterangepicker({singleDatePicker:!0,minDate:moment(),minYear:2022,maxYear:parseInt(moment().format("YYYY"),10),autoApply:!0,locale:{format:"DD.MM.YYYY"}}),$("#transferDate").on("apply.daterangepicker",function(e,t){$("label.showTrfDate.day-name").html(t.startDate.format("dddd")),$("div.showTrfDate.day-no").html(t.startDate.format("DD")),$("div.showTrfDate.month-name").html(t.startDate.format("MMM")),$('input[name="transferDate"]').val(t.startDate.format("DD.MM.YYYY")),$("img.showTrfImg").hide(),$(".showTrfDate").show()}),$("#trfReturnDate").daterangepicker({singleDatePicker:!0,autoUpdateInput:!1,minDate:moment(),minYear:2022,maxYear:parseInt(moment().format("YYYY"),10),autoApply:!0,locale:{format:"DD.MM.YYYY"}}),$("#trfReturnDate").on("apply.daterangepicker",function(e,t){$("label.showTrfRetDate.day-name").html(t.startDate.format("dddd")),$("div.showTrfRetDate.day-no").html(t.startDate.format("DD")),$("div.showTrfRetDate.month-name").html(t.startDate.format("MMM")),$("#trfReturnDate").val(t.startDate.format("DD.MM.YYYY")),$("img.showTrfRetImg").hide(),$(".showTrfRetDate").show()}),$("input.trf-people-count").on("change",function(){var a=0;$("input.trf-people-count").each(function(e,t){a+=parseInt($(t).val())}),$("#trfPax").html(a)});var e=document.querySelectorAll("#transferSearchForm"),t=(Array.prototype.slice.call(e).forEach(function(t){t.addEventListener("submit",function(e){t.checkValidity()?(t.classList.add("was-validated"),$("#loading").modal("show")):(e.preventDefault(),e.stopPropagation())},!1)}),$('[name="pageName"]').val()),o=(t&&(t=t.replace("/",""),window.location.pathname.substring(1)==t&&parseCookieSearchValues()),$.widget("custom.autocomplete",$.ui.autocomplete,{_renderMenu:function(a,e){var o=this,r="";$.each(e,function(e,t){t.category!=r&&(1==t.category?a.append("<li class='ui-autocomplete-category iconCity' >"+FmtMessage.getMessage("js.result.city")+"</li>"):4==t.category||3==t.category?a.append("<li class='ui-autocomplete-category iconDistrict' >"+FmtMessage.getMessage("js.result.district")+"</li>"):2==t.category?a.append("<li class='ui-autocomplete-category iconHotel' >"+FmtMessage.getMessage("js.result.hotel")+"</li>"):6==t.category&&a.append("<li class='ui-autocomplete-category iconAirport' >"+FmtMessage.getMessage("js.result.airport")+"</li>"),r=t.category),o._renderItemData(a,t)})},_renderItem:function(e,t){return t.label=t.value.replace(o,"<span class='searchTerm'>$1</span>"),$("<li></li>").data("item.autocomplete",t).append("<a>"+t.label+"</a>").appendTo(e)}}),null);$(".transferAutoComplete").click(function(){$(this).data("selected")||($(this).select(),$(this).data("selected",!0))}).focusout(function(){$(this).data("selected",!1);var e=this.value;$(this).data("label")!=e&&(this.value="",$("#"+this.id+"Id").val(""))}).autocomplete({source:function(t,a){var e=$("#"+$(this.element).data("dir")).val();$.ajax({url:"/transfer/locations",dataType:"json",data:{output:"json",results:100,query:t.term,otherAutoCompleteId:e},success:function(e){o=new RegExp("("+$.ui.autocomplete.escapeRegex(t.term)+")","gi"),a($.map(e,function(e){return{value:e.name,category:e.type,id:e.id}}))}})},minLength:2,open:function(e,t){$(".ui-autocomplete").off("menufocus hover mouseover mouseenter")},select:function(e,t){document.activeElement.blur(),$(this).data("label",t.item.value),$("#"+this.id+"Id").val(t.item.id),$("#"+this.id+"Type").val(t.item.category),1==$(this).attr("tabindex")?(transferSearch.searchAutoCompleteIdFrom=t.item.id,transferSearch.searchUrlFrom=t.item.value):(transferSearch.searchAutoCompleteIdTo=t.item.id,transferSearch.searchUrlTo=t.item.value)}}),$.ui.autocomplete.prototype._renderItem=function(e,t){return t.label=t.value.replace(o,"<span class='searchTerm'>$1</span>"),$("<li></li>").data("item.autocomplete",t).append("<a>"+t.label+"</a>").appendTo(e)},bindDatePicker();$("[name='hotelDetail']").val()||parseHotelCookieSearchValues(),Hotel.source&&((a=new Date).setTime(a.getTime()+18e5),$.cookie("source",Hotel.source,{expires:a,path:"/"})),$(".hotelAutoComplete").on("change",function(){$("html, body").animate({scrollTop:$("#hotelSearch").offset().top},500)}),$.widget("custom.catcomplete",$.ui.autocomplete,{_renderMenu:function(a,e){var o=this,r="";$.each(e,function(e,t){t.category!=r&&("HOTEL"==t.category?a.append("<li class='ui-autocomplete-category ui-state-disabled iconHotel' >"+FmtMessage.getMessage("js.result.hotel")+"</li>"):"CITY"==t.category?a.append("<li class='ui-autocomplete-category ui-state-disabled iconCity' >"+FmtMessage.getMessage("js.result.city")+"</li>"):"DISTRICT"==t.category&&a.append("<li class='ui-autocomplete-category ui-state-disabled iconDistrict' >"+FmtMessage.getMessage("js.result.district")+"</li>"),r=t.category),o._renderItemData(a,t)})},_renderItem:function(e,t){return t.label=t.value.replace(o,"<span class='searchTerm'>$1</span>"),$("<li class='ui-autocomplete-item'></li>").data("ui-autocomplete-item",t).append("<a>"+t.label+"</a>").appendTo(e)}});var a,o=null,e=($(".hotelAutoComplete").catcomplete({delay:500,source:function(t,a){$.ajax({url:"/hotel/hotels",dataType:"json",data:{output:"json",results:100,query:t.term},success:function(e){null==e&&(e=[]);e=$.map(e,function(e){return{value:e.name+" ( "+e.hotelCount+" "+FmtMessage.getMessage("js.title.hotel.name")+" ) ",key:e.id,category:e.type,name:e.name,hotelId:e.hotelId}}),o=new RegExp("("+$.ui.autocomplete.escapeRegex(t.term)+")","gi"),e=getHotelItemLabels(e);a(e)}})},minLength:2,select:function(e,t){document.activeElement.blur(),t.item.hotelId&&$('[name="id"]',this.form).val(t.item.hotelId),$('[name="id"]',this.form).val(t.item.key),$(this).data("autoCompleteResult",t.item.value),$('[name="urlHotelName"]').length||$("<input>").attr({type:"hidden",id:"urlHotelName",name:"urlHotelName"}).appendTo(this.form),$('[name="urlHotelName"]').val(t.item.name)},open:function(e,t){$(".ui-autocomplete").off("menufocus hover mouseover mouseenter")}}).change(function(e){$(this).data("autoCompleteResult")!=this.value&&$('[name="id"]',this.form).val("")}),$.ui.autocomplete.prototype._renderItem=function(e,t){return t.label=t.value.replace(o,"<span class='searchTerm'>$1</span>"),$("<li></li>").data("ui-autocomplete-item",t).append("<a>"+t.label+"</a>").appendTo(e)},bindRoomSelector(),$(".hotelAutoComplete").click(function(){$(this).select()}),document.querySelectorAll("#hotelSearchForm"));Array.prototype.slice.call(e).forEach(function(t){t.addEventListener("submit",function(e){checkForSearchHotel(t,e)},!1)})}),window.onbeforeunload=function(){var e,t=new Date;t.setTime(t.getTime()+864e5),$.cookie("transferSearchValues")&&(e=JSON.parse($.cookie("transferSearchValues")),transferSearch.searchAutoCompleteIdFrom||(transferSearch.searchAutoCompleteIdFrom=e.searchAutoCompleteIdFrom,transferSearch.searchUrlFrom=e.searchUrlFrom),transferSearch.searchAutoCompleteIdTo||(transferSearch.searchAutoCompleteIdTo=e.searchAutoCompleteIdTo,transferSearch.searchUrlTo=e.searchUrlTo),transferSearch.fromDate||(transferSearch.fromDate=e.fromDate),transferSearch.toDate||(transferSearch.toDate=e.toDate)),null!=transferSearch.searchAutoCompleteIdFrom&&$.cookie("transferSearchValues",JSON.stringify(transferSearch),{expires:t,path:"/"})};
//# sourceMappingURL=searchWidget.js.map
